<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Spatial and temporal requirements of breeding Least Terns in the Barataria-Terrebonne National Estuary through the use of Motus automated radio-telemetry data</title>
  <meta name="description" content="Spatial and temporal requirements of breeding Least Terns in the Barataria-Terrebonne National Estuary through the use of Motus automated radio-telemetry data">
  <meta name="generator" content="bookdown 0.7 and GitBook 2.6.7">

  <meta property="og:title" content="Spatial and temporal requirements of breeding Least Terns in the Barataria-Terrebonne National Estuary through the use of Motus automated radio-telemetry data" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Spatial and temporal requirements of breeding Least Terns in the Barataria-Terrebonne National Estuary through the use of Motus automated radio-telemetry data" />
  
  
  

<meta name="author" content="Zoe Crysler, Stuart Mackenzie, Adam Smith">


<meta name="date" content="2020-01-15">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="Recommendations.html">
<link rel="next" href="AppendixB.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><strong><a href="./">LETE analysis</a></strong></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="Methods.html"><a href="Methods.html"><i class="fa fa-check"></i><b>1</b> Methods</a><ul>
<li class="chapter" data-level="1.1" data-path="Methods.html"><a href="Methods.html#data-download"><i class="fa fa-check"></i><b>1.1</b> Data Download</a></li>
<li class="chapter" data-level="1.2" data-path="Methods.html"><a href="Methods.html#data-cleaning"><i class="fa fa-check"></i><b>1.2</b> Data Cleaning</a></li>
<li class="chapter" data-level="1.3" data-path="Methods.html"><a href="Methods.html#data-manipulation"><i class="fa fa-check"></i><b>1.3</b> Data Manipulation</a></li>
<li class="chapter" data-level="1.4" data-path="Methods.html"><a href="Methods.html#site-visits"><i class="fa fa-check"></i><b>1.4</b> Site Visits</a></li>
<li class="chapter" data-level="1.5" data-path="Methods.html"><a href="Methods.html#time-partitioning"><i class="fa fa-check"></i><b>1.5</b> Time Partitioning</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="Results.html"><a href="Results.html"><i class="fa fa-check"></i><b>2</b> Results</a><ul>
<li class="chapter" data-level="2.1" data-path="Results.html"><a href="Results.html#study-area"><i class="fa fa-check"></i><b>2.1</b> Study Area</a></li>
<li class="chapter" data-level="2.2" data-path="Results.html"><a href="Results.html#detection-overview"><i class="fa fa-check"></i><b>2.2</b> Detection Overview</a></li>
<li class="chapter" data-level="2.3" data-path="Results.html"><a href="Results.html#foraging-vs-incubating"><i class="fa fa-check"></i><b>2.3</b> Foraging vs Incubating</a></li>
<li class="chapter" data-level="2.4" data-path="Results.html"><a href="Results.html#heavily-frequented-foraging-areas"><i class="fa fa-check"></i><b>2.4</b> Heavily Frequented Foraging Areas</a><ul>
<li class="chapter" data-level="2.4.1" data-path="Results.html"><a href="Results.html#simultaneous-detections"><i class="fa fa-check"></i><b>2.4.1</b> Simultaneous Detections</a></li>
<li class="chapter" data-level="2.4.2" data-path="Results.html"><a href="Results.html#detection-directions"><i class="fa fa-check"></i><b>2.4.2</b> Detection Directions</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="Results.html"><a href="Results.html#mean-distances-travelled-for-foraging"><i class="fa fa-check"></i><b>2.5</b> Mean Distances Travelled for Foraging</a></li>
<li class="chapter" data-level="2.6" data-path="Results.html"><a href="Results.html#time-partitioning-between-foraging-and-nest-site-attendance"><i class="fa fa-check"></i><b>2.6</b> Time Partitioning Between Foraging and Nest Site Attendance</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="Conclusions.html"><a href="Conclusions.html"><i class="fa fa-check"></i><b>3</b> Conclusions</a><ul>
<li class="chapter" data-level="3.1" data-path="Conclusions.html"><a href="Conclusions.html#heavily-frequented-foraging-areas-1"><i class="fa fa-check"></i><b>3.1</b> Heavily Frequented Foraging Areas</a></li>
<li class="chapter" data-level="3.2" data-path="Conclusions.html"><a href="Conclusions.html#mean-distances-travelled-for-foraging-1"><i class="fa fa-check"></i><b>3.2</b> Mean Distances Travelled for Foraging</a></li>
<li class="chapter" data-level="3.3" data-path="Conclusions.html"><a href="Conclusions.html#time-partitioning-between-foraging-and-nest-site-attendance-1"><i class="fa fa-check"></i><b>3.3</b> Time Partitioning Between Foraging and Nest Site Attendance</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="Recommendations.html"><a href="Recommendations.html"><i class="fa fa-check"></i><b>4</b> Recommendations</a></li>
<li class="appendix"><span><b>Appendix</b></span></li>
<li class="chapter" data-level="A" data-path="AppendixA.html"><a href="AppendixA.html"><i class="fa fa-check"></i><b>A</b> Appendix - Downloading and Cleaning Data</a><ul>
<li class="chapter" data-level="A.1" data-path="AppendixA.html"><a href="AppendixA.html#loading-packages"><i class="fa fa-check"></i><b>A.1</b> Loading Packages</a></li>
<li class="chapter" data-level="A.2" data-path="AppendixA.html"><a href="AppendixA.html#data-download---project-132"><i class="fa fa-check"></i><b>A.2</b> Data Download - project 132</a></li>
<li class="chapter" data-level="A.3" data-path="AppendixA.html"><a href="AppendixA.html#accessing-data"><i class="fa fa-check"></i><b>A.3</b> Accessing Data</a></li>
<li class="chapter" data-level="A.4" data-path="AppendixA.html"><a href="AppendixA.html#dataframe-of-motustagid-and-lotek-tag-id"><i class="fa fa-check"></i><b>A.4</b> Dataframe of motusTagID and Lotek tag ID</a></li>
<li class="chapter" data-level="A.5" data-path="AppendixA.html"><a href="AppendixA.html#cleaning-data"><i class="fa fa-check"></i><b>A.5</b> Cleaning Data</a></li>
</ul></li>
<li class="chapter" data-level="B" data-path="AppendixB.html"><a href="AppendixB.html"><i class="fa fa-check"></i><b>B</b> Appendix - Distances Between Receivers</a></li>
<li class="chapter" data-level="C" data-path="AppendixC.html"><a href="AppendixC.html"><i class="fa fa-check"></i><b>C</b> Appendix - Site Visits</a><ul>
<li class="chapter" data-level="C.1" data-path="AppendixC.html"><a href="AppendixC.html#unique-visits"><i class="fa fa-check"></i><b>C.1</b> Unique Visits</a></li>
<li class="chapter" data-level="C.2" data-path="AppendixC.html"><a href="AppendixC.html#visits-by-tag-and-station"><i class="fa fa-check"></i><b>C.2</b> Visits by tag and station</a></li>
<li class="chapter" data-level="C.3" data-path="AppendixC.html"><a href="AppendixC.html#visits-by-station"><i class="fa fa-check"></i><b>C.3</b> Visits by Station</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Spatial and temporal requirements of breeding Least Terns in the Barataria-Terrebonne National Estuary through the use of Motus automated radio-telemetry data</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="AppendixA" class="section level1">
<h1><span class="header-section-number">A</span> Appendix - Downloading and Cleaning Data</h1>
<p>Detailed instructions for accessing and understanding data can be found in the Motus R Book, available <a href="https://motus.org/MotusRBook/">here</a>.</p>
<div id="loading-packages" class="section level2">
<h2><span class="header-section-number">A.1</span> Loading Packages</h2>
<p>In order to download data and complete the analysis you will need a number of packages, if you do not already have them installed, follow the instructions below:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Install devtools to allow download of Motus R</span>
<span class="co"># packages</span>
<span class="kw">install.packages</span>(<span class="st">&quot;devtools&quot;</span>)

<span class="co"># Install motus for data download, data</span>
<span class="co"># manipulation, visualization and analysis</span>
<span class="kw">install_github</span>(<span class="st">&quot;MotusWTS/motus&quot;</span>)

<span class="co"># install motusClient for data download</span>
<span class="kw">install_github</span>(<span class="st">&quot;MotusWTS/motusClient&quot;</span>)

<span class="co"># install packages for analysis</span>
<span class="kw">install.packages</span>(<span class="st">&quot;ggmap&quot;</span>)
<span class="kw">install.packages</span>(<span class="st">&quot;tidyr&quot;</span>)
<span class="kw">install.packages</span>(<span class="st">&quot;gridExtra&quot;</span>)
<span class="kw">install.packages</span>(<span class="st">&quot;ggplot2&quot;</span>)
<span class="kw">install.packages</span>(<span class="st">&quot;viridis&quot;</span>)
<span class="kw">install.packages</span>(<span class="st">&quot;knitr&quot;</span>)
<span class="kw">install.packages</span>(<span class="st">&quot;pander&quot;</span>)</code></pre></div>
<p>Once packages are installed, load them into your project. To download and filter the data we will only need use of the motus R package which is loaded with the ‘library’ function:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># load motus package</span>
<span class="kw">library</span>(motus)</code></pre></div>
</div>
<div id="data-download---project-132" class="section level2">
<h2><span class="header-section-number">A.2</span> Data Download - project 132</h2>
<p>Downloading data from Motus requires you to enter your Motus username and password, you will only have access to data for projects to which you are registered. To register with Motus visit <a href="https://motus.org/" class="uri">https://motus.org/</a>.</p>
<p>To download data for the <strong>first time</strong> to your working directory:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">proj.num &lt;-<span class="st"> </span><span class="dv">132</span>  <span class="co"># assign the correct project number</span>
sql.motus &lt;-<span class="st"> </span><span class="kw">tagme</span>(<span class="dt">projRecv =</span> proj.num, <span class="dt">new =</span> <span class="ot">TRUE</span>, 
    <span class="dt">update =</span> <span class="ot">TRUE</span>)</code></pre></div>
<p>To update an existing sql.motus file to your working directory:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">proj.num &lt;-<span class="st"> </span><span class="dv">132</span>  <span class="co"># assign the correct project number</span>
sql.motus &lt;-<span class="st"> </span><span class="kw">tagme</span>(<span class="dt">projRecv =</span> proj.num, <span class="dt">new =</span> <span class="ot">FALSE</span>, 
    <span class="dt">update =</span> <span class="ot">TRUE</span>)</code></pre></div>
</div>
<div id="accessing-data" class="section level2">
<h2><span class="header-section-number">A.3</span> Accessing Data</h2>
<p>Data is downloaded as an SQL file, to analyze data the SQL file is converted into a flat file and only relevant columns and Least Tern tags are retained. At the same time a new column for receiver latitude and longitude is created, consisting of the GPS latitude if available, infilled with the deployment latitude if GPS is not available.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">tbl.alltags &lt;-<span class="st"> </span><span class="kw">tbl</span>(sql.motus, <span class="st">&quot;alltags&quot;</span>) <span class="co"># convert sql file to a tbl</span>
df.alltags &lt;-<span class="st"> </span>tbl.alltags <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">recvLat =</span> <span class="kw">if_else</span>((<span class="kw">is.na</span>(gpsLat)<span class="op">|</span>gpsLat <span class="op">==</span><span class="st"> </span><span class="dv">0</span>), <span class="co"># create new lat/lon variables</span>
                           recvDeployLat, gpsLat), 
         <span class="dt">recvLon =</span> <span class="kw">if_else</span>((<span class="kw">is.na</span>(gpsLon)<span class="op">|</span>gpsLon <span class="op">==</span><span class="st"> </span><span class="dv">0</span>), 
                           recvDeployLon, gpsLon)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="co">#remove unnecessary columns</span>
<span class="st">  </span><span class="kw">select</span>(<span class="op">-</span>ambigID, <span class="op">-</span>tagProjID, <span class="op">-</span>sigsd, <span class="op">-</span>noise, <span class="op">-</span>freq, <span class="op">-</span>freqsd, <span class="op">-</span>slop, <span class="op">-</span>burstSlop, 
         <span class="op">-</span>done, <span class="op">-</span>bootnum, <span class="op">-</span>tagType, <span class="op">-</span>codeSet, <span class="op">-</span>mfg, <span class="op">-</span>tagModel, <span class="op">-</span>tagLifespan, 
         <span class="op">-</span>nomFreq, <span class="op">-</span>pulseLen, <span class="op">-</span>markerNumber, <span class="op">-</span>markerType, <span class="op">-</span>tagDeployAlt, 
         <span class="op">-</span>tagDeployComments, <span class="op">-</span>fullID, <span class="op">-</span>recvDeployAlt, <span class="op">-</span>antHeight, <span class="op">-</span>speciesFR, 
         <span class="op">-</span>speciesSci, <span class="op">-</span>speciesGroup, <span class="op">-</span>tagProjName, gpsAlt, recvSiteName) <span class="op">%&gt;%</span><span class="st">  </span>
<span class="st">  </span><span class="kw">filter</span>(speciesEN <span class="op">==</span><span class="st"> &quot;Least Tern&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="co"># keep only LETE</span>
<span class="st">  </span><span class="kw">collect</span>() <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>as.data.frame <span class="op">%&gt;%</span><span class="st"> </span><span class="co"># convert tbl to data.frame</span>
<span class="st">  </span><span class="co"># convert times to datetime</span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">ts =</span> <span class="kw">as_datetime</span>(ts, <span class="dt">tz =</span> <span class="st">&quot;UTC&quot;</span>, <span class="dt">origin =</span> <span class="st">&quot;1970-01-01&quot;</span>),
         <span class="dt">tagDeployStart =</span> <span class="kw">as_datetime</span>(tagDeployStart, <span class="dt">tz =</span> <span class="st">&quot;UTC&quot;</span>, <span class="dt">origin =</span> <span class="st">&quot;1970-01-01&quot;</span>),
         <span class="dt">tagDeployEnd =</span> <span class="kw">as_datetime</span>(tagDeployEnd, <span class="dt">tz =</span> <span class="st">&quot;UTC&quot;</span>, <span class="dt">origin =</span> <span class="st">&quot;1970-01-01&quot;</span>))</code></pre></div>
</div>
<div id="dataframe-of-motustagid-and-lotek-tag-id" class="section level2">
<h2><span class="header-section-number">A.4</span> Dataframe of motusTagID and Lotek tag ID</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">tagIDs &lt;-<span class="st"> </span><span class="kw">unique</span>(<span class="kw">select</span>(df.alltags, motusTagID, mfgID))</code></pre></div>
</div>
<div id="cleaning-data" class="section level2">
<h2><span class="header-section-number">A.5</span> Cleaning Data</h2>
<p>Projects with receivers in the tagging area are 31, 65, 120, and 132, initially all detections from receivers registered to these projects will be retained. For all other projects any detections with a runLen &lt; 2 are deemed to be false positives. Filter ‘blocks’ are created each time a detection is identified as a false positive, at the end of the cleaning process all the false positive blocks are combined to create a single filter to apply to all the data.</p>
<p>First, remove detections outside tagging area with a runLen of 2:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># create list of projects with receivers outside the tagging area</span>
nonTaggingLocs &lt;-<span class="st"> </span><span class="kw">unique</span>(<span class="kw">filter</span>(df.alltags, 
                                <span class="op">!</span>(recvProjID <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="dv">31</span>, <span class="dv">65</span>, <span class="dv">120</span>, <span class="dv">132</span>)))<span class="op">$</span>recvProjID)
lete17 &lt;-<span class="st"> </span><span class="kw">filter</span>(df.alltags, <span class="kw">year</span>(ts) <span class="op">==</span><span class="st"> </span><span class="dv">2017</span>, <span class="co"># filter to only 2017 detections</span>
                 <span class="op">!</span>(recvProjID <span class="op">%in%</span><span class="st"> </span>nonTaggingLocs <span class="op">&amp;</span><span class="st"> </span>runLen <span class="op">==</span><span class="st"> </span><span class="dv">2</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="co"># remove detections with a runLen &lt;= 2 for stations outside tagging area</span>
<span class="st">  </span><span class="kw">arrange</span>(motusTagID, ts)

<span class="co"># create the first filter block</span>
df.block.<span class="dv">0</span> &lt;-<span class="st"> </span><span class="kw">filter</span>(df.alltags, <span class="kw">year</span>(ts) <span class="op">==</span><span class="st"> </span><span class="dv">2017</span>, 
                     recvProjID <span class="op">%in%</span><span class="st"> </span>nonTaggingLocs <span class="op">&amp;</span><span class="st"> </span>runLen <span class="op">==</span><span class="st"> </span><span class="dv">2</span>)</code></pre></div>
<p>Next, detections are plotted by latitude to visually identify other questionable detections to eventually create more blocks of false positives for the final filter. Below are detections for all 2017 tags by latitude: <img src="LETE_Analysis_files/figure-html/2017filterPlots1-1.png" width="672" /> Tags are removed that were never detected at the breeding site, these are <strong>23220</strong>, <strong>23221</strong>, and <strong>23222</strong>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># remove tags 23220, 23221, 23222 and create a</span>
<span class="co"># block</span>
lete17 &lt;-<span class="st"> </span><span class="kw">filter</span>(lete17, <span class="op">!</span>(motusTagID <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="dv">23220</span>, 
    <span class="dv">23221</span>, <span class="dv">23222</span>)))
df.block.<span class="dv">1</span> &lt;-<span class="st"> </span><span class="kw">filter</span>(df.alltags, <span class="kw">year</span>(ts) <span class="op">==</span><span class="st"> </span><span class="dv">2017</span> <span class="op">&amp;</span><span class="st"> </span>
<span class="st">    </span>motusTagID <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="dv">23220</span>, <span class="dv">23221</span>, <span class="dv">23222</span>))</code></pre></div>
<p>Next, tags that were detected outside the breeding area are examined: <strong>23212, 23214, 23216, 23219, 23223, 23225, 23226, 23227, 23270</strong>. Below is a plot of these tags, and a table displaying the number of runs with runLen &lt; 5 for each station:</p>
<p><img src="LETE_Analysis_files/figure-html/2017filterPlots3-1.png" width="672" /></p>
<pre><code>##                                       recvDeployName runLen    n
## 1                                      Bolivar_Flats      2    2
## 2                                       Peveto Woods      2    2
## 3  San Bernard National Wildlife Refuge Headquarters      2    2
## 4                                         Sabine NWR      2    4
## 5                      Rockport Bay Education Center      2    6
## 6                                        High_Island      2    8
## 7                                             Wisner      2    8
## 8                                   Scenic Galveston      2   24
## 9                                           Quintana      2   28
## 10                   San Bernard NWR (Big Pond Unit)      2   30
## 11                                        Grand_Isle      2   82
## 12                                      Exxon Fields      2 4688
## 13                                              RTNJ      3    3
## 14                                       Swallowtail      3    3
## 15                                           Drasher      3    9
## 16                                            Wisner      3   12
## 17                                     Waggoners Gap      3   60
## 18                                           Koffler      3   72
## 19                                        Grand_Isle      3  120
## 20                                        Burntpoint      3  258
## 21                                Los Vientos Forest      3  411
## 22                                      Exxon Fields      3 5736
## 23                                           Koffler      4   12
## 24                                     Waggoners Gap      4   12
## 25                                Los Vientos Forest      4   32
## 26                                        Grand_Isle      4   72
## 27                                      Exxon Fields      4 4952</code></pre>
<p>Stations that stand out as having a large number of runLen = 3, far outside the tagging area include: <em>Koffler</em>, <em>Waggoners Gap</em>, <em>Burntpoint</em>, and <em>Los Vientos Forest</em>. These are likely sites with a large amount of background radio noise leading to increased levels of false positives. To confirm, a few examples are provided below.</p>
<p>For <strong>tag 23216</strong>, given the amount of time and distance between detections at <em>RTNJ</em> and <em>Exxon Fields</em>, and between <em>Koffler</em> and <em>Exxon Fields</em>, these are not biologically possible flights and these detections will be removed: <img src="LETE_Analysis_files/figure-html/2017filterPlots4-1.png" width="672" /></p>
<p>For <strong>tag 23270</strong>, it again appears there are clear false positives that can be removed at <em>Koffler</em>, <em>Los Vientos Forest</em>, <em>Drasher</em>, and <em>Waggoners Gap</em>. These detections will therefore be flagged as false positives: <img src="LETE_Analysis_files/figure-html/2017filterPlots5-1.png" width="672" /></p>
<p>Create a filter block to remove noisy sites with high amounts of short runLen’s:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">df.block.<span class="dv">2</span> &lt;-<span class="st"> </span><span class="kw">filter</span>(df.alltags, <span class="kw">year</span>(ts) <span class="op">==</span><span class="st"> </span><span class="dv">2017</span>, 
    recvDeployName <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Drasher&quot;</span>, <span class="st">&quot;RTNJ&quot;</span>, <span class="st">&quot;Koffler&quot;</span>, 
        <span class="st">&quot;Waggoners Gap&quot;</span>, <span class="st">&quot;Burntpoint&quot;</span>, <span class="st">&quot;Los Vientos Forest&quot;</span>))</code></pre></div>
<p>Removing the sites with a high number of low runLen’s (<em>Drasher</em>, <em>RTNJ</em>, <em>Koffler</em>, <em>Waggoners Gap</em>, <em>Burntpoint</em>, <em>Los Vientos Forest</em>) results in much cleaner plots:</p>
<p><img src="LETE_Analysis_files/figure-html/2017filterPlots7-1.png" width="672" /></p>
<p>There are three remaining tags with questionable detections: <strong>23219, 23225, 23227</strong>:</p>
<p><img src="LETE_Analysis_files/figure-html/2017filterPlots8-1.png" width="672" /></p>
<p>To determine if detections are reliable, each tag will be examined on an individual basis.</p>
<p><strong>Tag 23219</strong>: Detections at Rockport Bay Education Center are only runLen 2, these are not reliable detections: <img src="LETE_Analysis_files/figure-html/2017filterPlots9-1.png" width="672" /></p>
<p><strong>Tag 23225</strong>: detections at Peveto Woods are only runLen 2, these are not reliable detections: <img src="LETE_Analysis_files/figure-html/2017filterPlots10-1.png" width="672" /></p>
<p><strong>Tag 23227</strong>: all detections after June 15 are of runLen 2, except for detections at Swallowtail (receiver latitude = 45, runLen = 3) which are too far away to be legitimate detections so these will be removed. <img src="LETE_Analysis_files/figure-html/2017filterPlots11-1.png" width="672" /></p>
<p>A filter block is created to remove false detections for the three tags above:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">df.block.<span class="dv">3</span> &lt;-<span class="st"> </span><span class="kw">filter</span>(df.alltags, <span class="kw">year</span>(ts) <span class="op">==</span><span class="st"> </span><span class="dv">2017</span>, 
    motusTagID <span class="op">==</span><span class="st"> </span><span class="dv">23219</span> <span class="op">&amp;</span><span class="st"> </span>recvDeployName <span class="op">==</span><span class="st"> &quot;Rockport Bay Education Center&quot;</span>)
df.block.<span class="dv">4</span> &lt;-<span class="st"> </span><span class="kw">filter</span>(df.alltags, <span class="kw">year</span>(ts) <span class="op">==</span><span class="st"> </span><span class="dv">2017</span>, 
    motusTagID <span class="op">==</span><span class="st"> </span><span class="dv">23225</span> <span class="op">&amp;</span><span class="st"> </span>recvDeployName <span class="op">==</span><span class="st"> &quot;Peveto Woods&quot;</span>)
df.block.<span class="dv">5</span> &lt;-<span class="st"> </span><span class="kw">filter</span>(df.alltags, <span class="kw">year</span>(ts) <span class="op">==</span><span class="st"> </span><span class="dv">2017</span>, 
    motusTagID <span class="op">==</span><span class="st"> </span><span class="dv">23227</span> <span class="op">&amp;</span><span class="st"> </span>ts <span class="op">&gt;</span><span class="st"> </span><span class="kw">as.POSIXct</span>(<span class="st">&quot;2017-06-15&quot;</span>))</code></pre></div>
<p>The process is repeated with 2018 detection data, starting by removing detections from stations outside the tagging area with a runLen &lt; 2:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># create list of projects with receivers outside the tagging area</span>
lete18 &lt;-<span class="st"> </span><span class="kw">filter</span>(df.alltags, <span class="kw">year</span>(ts) <span class="op">==</span><span class="st"> </span><span class="dv">2018</span>, <span class="co"># filter to only 2018 detections</span>
                 <span class="op">!</span>(recvProjID <span class="op">%in%</span><span class="st"> </span>nonTaggingLocs <span class="op">&amp;</span><span class="st"> </span>runLen <span class="op">==</span><span class="st"> </span><span class="dv">2</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="co"># remove detections with a runLen &lt; 2 for stations outside tagging area</span>
<span class="st">  </span><span class="kw">arrange</span>(motusTagID, ts)
<span class="co"># create the first filter block</span>
df.block.<span class="dv">6</span> &lt;-<span class="st"> </span><span class="kw">filter</span>(df.alltags, <span class="kw">year</span>(ts) <span class="op">==</span><span class="st"> </span><span class="dv">2018</span>, 
                     recvProjID <span class="op">%in%</span><span class="st"> </span>nonTaggingLocs <span class="op">&amp;</span><span class="st"> </span>runLen <span class="op">==</span><span class="st"> </span><span class="dv">2</span>)</code></pre></div>
<p>Next, all tags are plotted by latitude to visually identify potential false positives.</p>
<p>Plot of all 2018 tags by latitude:</p>
<p><img src="LETE_Analysis_files/figure-html/2018filterPlots1-1.png" width="672" /></p>
<p>Tags that were never detected at the breeding site are removed and a filter block is created: <strong>28614</strong></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">lete18 &lt;-<span class="st"> </span><span class="kw">filter</span>(lete18, <span class="op">!</span>(motusTagID <span class="op">==</span><span class="st"> </span><span class="dv">28614</span>))
df.block.<span class="dv">7</span> &lt;-<span class="st"> </span><span class="kw">filter</span>(df.alltags, <span class="kw">year</span>(ts) <span class="op">==</span><span class="st"> </span><span class="dv">2018</span>, 
    motusTagID <span class="op">==</span><span class="st"> </span><span class="dv">28614</span>)</code></pre></div>
<p>Next tags that were detected outside breeding area were examined: <strong>28520, 28524, 28525, 28531, 28594, 28600</strong></p>
<p><img src="LETE_Analysis_files/figure-html/2018filterPlots3-1.png" width="672" /></p>
<p>Again, runLen for these detections is examined:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">filter</span>(lete18, motusTagID <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="dv">28520</span>, <span class="dv">28524</span>, <span class="dv">28525</span>, 
    <span class="dv">28531</span>, <span class="dv">28594</span>, <span class="dv">28600</span>), runLen <span class="op">&lt;</span><span class="st"> </span><span class="dv">5</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">group_by</span>(recvDeployName, 
    runLen) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">summarize</span>(<span class="dt">n =</span> <span class="kw">length</span>(motusTagID)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">    </span><span class="kw">as.data.frame</span>() <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">arrange</span>(runLen, n)</code></pre></div>
<pre><code>##                                       recvDeployName runLen    n
## 1  San Bernard National Wildlife Refuge Headquarters      2    2
## 2                        Trinity River NWR Die House      2    2
## 3                                      Bolivar_Flats      2    4
## 4                                   East Grand Terre      2    6
## 5                    San Bernard NWR (Big Pond Unit)      2   14
## 6                  Brazoria National Wildlife Refuge      2   18
## 7                                         Grand_Isle      2   82
## 8                                       Exxon Fields      2 3174
## 9                                               BPLH      3    3
## 10                                           Curries      3    3
## 11                                           Drasher      3    3
## 12                                        Stutchbury      3    3
## 13                                           Old Cut      3    6
## 14                                           Koffler      3   12
## 15                                        Grand_Isle      3   48
## 16                                    D&#39;Estimauville      3  159
## 17                                      Exxon Fields      3 2391
## 18                                           Koffler      4    8
## 19                                    D&#39;Estimauville      4   20
## 20                                        Grand_Isle      4   32
## 21                                      Exxon Fields      4 1592</code></pre>
<p>Stations that stand out as having a large number of runLen = 3, far outside the tagging area include:<em>D’Estimauville</em>, and as in 2017 <em>Koffler</em>. These are likely sites with a large amount of background radio noise leading to increased levels of false positives. Tags detected at these stations are examined individually to remove false positives.</p>
<p><strong>Tag 28520</strong>: The detections at <em>D’Estimauville</em> in Quebec are not biologically possible given the timing, and was also flagged as a noisy site, these detections are flagged as false positives. <img src="LETE_Analysis_files/figure-html/2018filterPlots5-1.png" width="672" /></p>
<p><strong>Tag 28524</strong>: Given the amount of time and distance between detections at <em>Koffler</em> and <em>Exxon Fields</em>, and between <em>D’Estimauville</em> and <em>Exxon Fields</em>, these are not biologically possible flights, they were also flagged as noisy stations. The detections at Stutchbury and Curries are of runLen 3, and occur in Ontario and Pennsylvania respectively. These detections are therefore flagged as false positives. <img src="LETE_Analysis_files/figure-html/2018filterPlots6-1.png" width="672" /></p>
<p><strong>Tag 28525</strong>: Just as with tag 28520, the detection at <em>D’Estimauville</em> will be removed.</p>
<p><img src="LETE_Analysis_files/figure-html/2018filterPlots7-1.png" width="672" /></p>
<p><strong>Tag 28531</strong>: Again, it is unlikely that this tag was in Ontario and Quebec in June so detections at <em>Koffler</em>, <em>Old Cut</em>, and <em>D’Estimauville</em> will be removed.</p>
<p><img src="LETE_Analysis_files/figure-html/2018filterPlots8-1.png" width="672" /></p>
<p><strong>Tag 28594</strong>: Again, it is unlikely that this tag was in Nova Scotia, Ontario, or Pennsylvania (stations <em>BPLH</em>, <em>Old Cut</em>, and <em>Drasher</em> respectively), and all runLen are 3, so detections at these stations will be removed. <img src="LETE_Analysis_files/figure-html/2018filterPlots-1.png" width="672" /></p>
<p><strong>Tag 28600</strong>: Detections at <em>Koffler</em> and <em>D’Estimauville</em> once again appear problematic and will be removed. <img src="LETE_Analysis_files/figure-html/2018filterPlots10-1.png" width="672" /></p>
<p>Since all false positives in these cases are for the same stations, one filter block is used to apply to these false detections:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">df.block.<span class="dv">8</span> &lt;-<span class="st"> </span><span class="kw">filter</span>(df.alltags, <span class="kw">year</span>(ts) <span class="op">==</span><span class="st"> </span><span class="dv">2018</span>, 
    recvDeployName <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;D&#39;Estimauville&quot;</span>, <span class="st">&quot;Koffler&quot;</span>, 
        <span class="st">&quot;Stutchbury&quot;</span>, <span class="st">&quot;Curries&quot;</span>, <span class="st">&quot;Old Cut&quot;</span>, <span class="st">&quot;BPLH&quot;</span>, 
        <span class="st">&quot;Drasher&quot;</span>))</code></pre></div>
<p>Here the plots are redone after removing the above identified false positives:</p>
<p><img src="LETE_Analysis_files/figure-html/2018filterPlots12-1.png" width="672" /></p>
<p>Now that filter blocks have been created for all false positives, a single custom filter is created for all false positives. The Motus R package offers functionalities to save your filters directly within your .motus file. Once they’re saved in your database, you can do the type of left_join as below without having to rely on data frames or an RDS file to store your data. More info can be found in <a href="https://motus.org/MotusRBook/appendixD.html">Appendix D</a> of the Motus R Book.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Combine our df.blocks into a single data frame,</span>
<span class="co"># and apply a probability of 0 for filtered</span>
<span class="co"># records.</span>
df.block.all &lt;-<span class="st"> </span><span class="kw">bind_rows</span>(df.block.<span class="dv">0</span>, df.block.<span class="dv">1</span>, df.block.<span class="dv">2</span>, 
    df.block.<span class="dv">3</span>, df.block.<span class="dv">4</span>, df.block.<span class="dv">5</span>, df.block.<span class="dv">6</span>, 
    df.block.<span class="dv">7</span>, df.block.<span class="dv">8</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">probability =</span> <span class="dv">0</span>)

<span class="co"># Create a new filter with the name filtFalsePos</span>
<span class="co"># and populate it with df.block.all</span>
tbl.filter =<span class="st"> </span><span class="kw">writeRunsFilter</span>(sql.motus, <span class="st">&quot;filtFalsePos&quot;</span>, 
    <span class="dt">df =</span> df.block.all, <span class="dt">delete =</span> <span class="ot">TRUE</span>)

<span class="co"># Obtain a table object where the filtered records</span>
<span class="co"># from tbl.filter have been removed</span>
tbl.alltags.sub &lt;-<span class="st"> </span><span class="kw">left_join</span>(tbl.alltags, tbl.filter, 
    <span class="dt">by =</span> <span class="kw">c</span>(<span class="st">&quot;runID&quot;</span>, <span class="st">&quot;motusTagID&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">probability =</span> <span class="kw">ifelse</span>(<span class="kw">is.na</span>(probability), 
    <span class="dv">1</span>, probability)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(probability <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>)</code></pre></div>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="Recommendations.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="AppendixB.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"download": ["LETE_Analysis.pdf"],
"toc": {
"collapse": "section"
}
});
});
</script>

</body>

</html>
